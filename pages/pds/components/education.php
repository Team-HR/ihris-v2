<div class="education-form">
    <h2 class="text-2xl font-bold mb-4">Educational Background</h2>

    <!-- Elementary (school_level = 1) -->
    <div class="mb-6 p-4 rounded" data-level="1">
        <h3 class="text-xl font-semibold mb-3">Elementary</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label for="school_1" class="block mb-1">Name of School</label>
                <input type="text" id="school_1" name="nameschool" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="degree_1" class="block mb-1">Degree/Course</label>
                <input type="text" id="degree_1" name="degreecourse" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="from_1" class="block mb-1">From (Year)</label>
                <input type="number" id="from_1" name="fromdate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="to_1" class="block mb-1">To (Year)</label>
                <input type="number" id="to_1" name="todate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="graduated_1" class="block mb-1">Year Graduated</label>
                <input type="number" id="graduated_1" name="yeargraduated" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="awards_1" class="block mb-1">Academic Awards</label>
                <input type="text" id="awards_1" name="academicawards" class="input input-bordered w-full" placeholder="N/A">
            </div>
        </div>
    </div>

    <!-- Secondary (school_level = 2) -->
    <div class="mb-6 p-4 rounded" data-level="2">
        <h3 class="text-xl font-semibold mb-3">Secondary</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label for="school_2" class="block mb-1">Name of School</label>
                <input type="text" id="school_2" name="nameschool" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="degree_2" class="block mb-1">Degree/Course</label>
                <input type="text" id="degree_2" name="degreecourse" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="from_2" class="block mb-1">From (Year)</label>
                <input type="number" id="from_2" name="fromdate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="to_2" class="block mb-1">To (Year)</label>
                <input type="number" id="to_2" name="todate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="graduated_2" class="block mb-1">Year Graduated</label>
                <input type="number" id="graduated_2" name="yeargraduated" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="awards_2" class="block mb-1">Academic Awards</label>
                <input type="text" id="awards_2" name="academicawards" class="input input-bordered w-full" placeholder="N/A">
            </div>
        </div>
    </div>

    <!-- Vocational (school_level = 3) -->
    <div class="mb-6 p-4 rounded" data-level="3">
        <h3 class="text-xl font-semibold mb-3">Vocational</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label for="school_3" class="block mb-1">Name of School</label>
                <input type="text" id="school_3" name="nameschool" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="degree_3" class="block mb-1">Degree/Course</label>
                <input type="text" id="degree_3" name="degreecourse" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="from_3" class="block mb-1">From (Year)</label>
                <input type="number" id="from_3" name="fromdate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="to_3" class="block mb-1">To (Year)</label>
                <input type="number" id="to_3" name="todate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="graduated_3" class="block mb-1">Year Graduated</label>
                <input type="number" id="graduated_3" name="yeargraduated" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="awards_3" class="block mb-1">Academic Awards</label>
                <input type="text" id="awards_3" name="academicawards" class="input input-bordered w-full" placeholder="N/A">
            </div>
        </div>
    </div>

    <!-- College (school_level = 4) -->
    <div class="mb-6 p-4" data-level="4">
        <h3 class="text-xl font-semibold mb-3">College</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label for="school_4" class="block mb-1">Name of School</label>
                <input type="text" id="school_4" name="nameschool" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="degree_4" class="block mb-1">Degree/Course</label>
                <input type="text" id="degree_4" name="degreecourse" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="from_4" class="block mb-1">From (Year)</label>
                <input type="number" id="from_4" name="fromdate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="to_4" class="block mb-1">To (Year)</label>
                <input type="number" id="to_4" name="todate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="graduated_4" class="block mb-1">Year Graduated</label>
                <input type="number" id="graduated_4" name="yeargraduated" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="awards_4" class="block mb-1">Academic Awards</label>
                <input type="text" id="awards_4" name="academicawards" class="input input-bordered w-full" placeholder="N/A">
            </div>
        </div>
    </div>

    <!-- Graduate Studies (school_level = 5) -->
    <div class="mb-6 p-4" data-level="5">
        <h3 class="text-xl font-semibold mb-3">Graduate Studies</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="form-control">
                <label for="school_5" class="block mb-1">Name of School</label>
                <input type="text" id="school_5" name="nameschool" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="degree_5" class="block mb-1">Degree/Course</label>
                <input type="text" id="degree_5" name="degreecourse" class="input input-bordered w-full" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="from_5" class="block mb-1">From (Year)</label>
                <input type="number" id="from_5" name="fromdate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="to_5" class="block mb-1">To (Year)</label>
                <input type="number" id="to_5" name="todate" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="graduated_5" class="block mb-1">Year Graduated</label>
                <input type="number" id="graduated_5" name="yeargraduated" class="input input-bordered w-full" min="1900" max="2100" placeholder="N/A">
            </div>
            <div class="form-control">
                <label for="awards_5" class="block mb-1">Academic Awards</label>
                <input type="text" id="awards_5" name="academicawards" class="input input-bordered w-full" placeholder="N/A">
            </div>
        </div>
    </div>

    <div class="mt-4 flex justify-end">
        <button id="saveEducation" class="btn btn-primary">Save</button>
    </div>


    <!-- <button id="saveEducation" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">Save Education</button> -->
</div>

<script>
    // Fetch education data
    async function fetchEducationData() {
        try {
            const empid = '24'; //new URLSearchParams(window.location.search).get('empid') || '24';
            const response = await api.get(`/api/pds?type=education&empid=${empid}`);
            console.log('educationRecords:', response);
            if (response) {
                const educationRecords = Array.isArray(response) ? response : [];
                // Populate each level based on school_level identifier
                educationRecords.forEach(record => {
                    const level = record.xschool_level;
                    if (level >= 1 && level <= 5) {
                        document.getElementById(`school_${level}`).value = record.nameschool || '';
                        document.getElementById(`degree_${level}`).value = record.degreecourse || '';
                        document.getElementById(`from_${level}`).value = record.fromdate || '';
                        document.getElementById(`to_${level}`).value = record.todate || '';
                        document.getElementById(`graduated_${level}`).value = record.yeargraduated || '';
                        document.getElementById(`awards_${level}`).value = record.academicawards || '';
                    }
                });
            }
        } catch (error) {
            console.error('Error fetching education data:', error);
        }
    }

    // Save education data
    document.getElementById('saveEducation').addEventListener('click', async function() {
        const empid = new URLSearchParams(window.location.search).get('empid') || '123';

        // Build array of education records
        const educationData = [];

        // Loop through each education level (1-5)
        for (let level = 1; level <= 5; level++) {
            educationData.push({
                xschool_level: level,
                nameschool: document.getElementById(`school_${level}`).value,
                degreecourse: document.getElementById(`degree_${level}`).value,
                fromdate: document.getElementById(`from_${level}`).value,
                todate: document.getElementById(`to_${level}`).value,
                yeargraduated: document.getElementById(`graduated_${level}`).value,
                academicawards: document.getElementById(`awards_${level}`).value
            });
        }

        try {
            await api.put(`/api/education?empid=${empid}`, {
                education: educationData
            });
            alert('Education data saved successfully!');
        } catch (error) {
            console.error('Error saving education data:', error);
            alert('Error saving education data. Please try again.');
        }
    });

    // Fetch data on page load
    fetchEducationData();
</script>